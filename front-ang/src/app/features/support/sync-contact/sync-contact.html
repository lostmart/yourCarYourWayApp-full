<!-- Login Screen -->
<div *ngIf="!isConnected" class="login-container">
  <div style="position: fixed; top: 190px; right: 10px; background: rgb(51, 51, 51); padding: 10px">
    DEBUG: isConnected = {{ isConnected }}, isConnecting = {{ isConnecting }}
  </div>
  <h2>Join Chat</h2>
  <input
    type="text"
    [(ngModel)]="username"
    placeholder="Enter your name"
    (keyup.enter)="connect()"
    [disabled]="isConnecting"
  />
  <button (click)="connect()" [disabled]="isConnecting || !username.trim()">
    {{ isConnecting ? 'Connecting...' : 'Join Chat' }}
  </button>
</div>

<!-- Chat Screen -->
<div *ngIf="isConnected" class="chat-container">
  <div class="chat-header">
    <h3>Chat - {{ username }}</h3>
    <button (click)="disconnect()">Leave</button>
  </div>

  <div #chatContainer class="messages-container">
    <div
      *ngFor="let message of messages; trackBy: trackByMessageId"
      class="message"
      [class.user-message]="isUserMessage(message)"
      [class.bot-message]="!isUserMessage(message)"
      [class.system-message]="message.type !== 'CHAT'"
    >
      <div *ngIf="message.type === 'CHAT'" class="message-bubble">
        <div class="message-sender">{{ message.sender }}</div>
        <div class="message-content">{{ message.content }}</div>
        <div class="message-time">{{ getMessageTime(message.timestamp) }}</div>
      </div>

      <div *ngIf="message.type === 'JOIN'" class="system-notification">
        {{ message.sender }} joined the chat
      </div>

      <div *ngIf="message.type === 'LEAVE'" class="system-notification">
        {{ message.sender }} left the chat
      </div>
    </div>
  </div>

  <div class="input-container">
    <input
      type="text"
      [(ngModel)]="newMessage"
      placeholder="Type a message..."
      (keyup.enter)="sendMessage()"
    />
    <button (click)="sendMessage()" [disabled]="!newMessage.trim()">Send</button>
  </div>
</div>
